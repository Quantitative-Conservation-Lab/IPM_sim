---
title: ''
output:
  word_document:
    reference_docx: mytemplate.docx
  pdf_document: default
---

To-do's

Presentation
- caroline/amelia

Write-up
- intro (amanda re-reads and checks for possible additions)
- methods/equation check: change YOTY to juv (hannah)
- simulation write-up (amelia)
- results (abby/hannah)

- discussion (TBD)
-- summarize high-level finding

-- why we think we see what we see
--- crux of the issue.... 
(1) how the life cycle model relies on different data sources
(2) parameter identifiability
(3) ?

-- limitations/caveats of this particular study (what can/can't we make inference to/about)
--- life histories

-- future directions
--- degrading quantity/quality

-- importance of the work
(1) understanding IPMs better
(2) understanding weaknesses of IPMs: when does the integration almost hurt instead of help?
(3) survey design

Figures/analysis/etc
- posterior densities (amanda)
- life cycle/survey timing diagram (amelia)
- figure captions/printing (amanda)
- 3 dags (amelia)

Code review
- annotate data simulation (amanda! caroline! amelia!)

Displaying results
- posterior densities
- table (true values, data included, posterior mean, 95% CI, mean bias, mean RMSE)



```{r include = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, results = 'asis', fig.width = 4, fig.height = 3.5)
#for reference: https://rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf

cols <- c("violetred4", "dodgerblue3", 'deepskyblue1', "#4aaaa5", "#a3d39c", "#f6b61c", "chocolate2", "red3")


```

```{r load packages, results = 'hide'}

library(tidyr)
library(dplyr)
library(cowplot)
library(ggplot2)
library(coda)
library(captioner)
library(knitr)
library(reshape2)
library(here)

#functions to use for calling figures/tables
figs <- captioner(prefix = "Figure")
tbls <- captioner(prefix = "Table")

#source a plot theme for figures
# source(here::here('scripts', 'PlotTheme.R'))

```


```{r figures - multiple chains, results = 'hide'}

#true vals
truth <- readRDS(here::here('data', 'scenarios.Rdata')) 
colnames(truth) <- gsub(' ', '', colnames(truth))
true_vals <- truth %>%
  dplyr::select(ScenarioNumber, MRdetection, Abunddetection, AdultSurv, JuvSurv, Dailynestsurvival, Fec) %>%
  dplyr::rename(scenario = ScenarioNumber) %>%
  reshape2::melt(id.vars = c('scenario'), value.name = 'Truth') %>%
  transform(variable = factor(variable,
                              levels = c('AdultSurv', 'JuvSurv', 'MRdetection', 'Fec', 'Abunddetection', 'Dailynestsurvival'),
                              labels = c('AdultSurv', 'JuvSurv', 'MRdetection', 'Fec', 'Abunddetection', 'Dailynestsurvival'))) %>%
  transform(Data = ifelse(scenario < 6, 'All', 
                          ifelse(scenario < 11 & scenario > 5, 'Counts + Productivity', 'Counts + MR'))) %>%
  transform(Truth = ifelse(Data == 'Counts + Productivity' & variable == 'MRdetection', NA, Truth))

# ~~~~~~~~~~~~~~~~~~~~~~~~~~ #

### assessing convergence

sc <- c(1:5, 11:15)
nsim <- 25
pars <- c('fec', 'lambdaf', 'mean.p', 'mean.phi[1]', 'mean.phi[2]', 'p.surv', 'phi.nest')

out_meds1 <- data.frame() #storage
for (s in sc) {
  for (i in 1:nsim) { 
chains <- as.mcmc.list(list(as.mcmc(readRDS(file = here::here('data', paste0('out', s, '_', i, '-', 1, '.Rdata')))), 
                            as.mcmc(readRDS(file = here::here('data', paste0('out', s, '_', i, '-', 2, '.Rdata')))), 
                            as.mcmc(readRDS(file = here::here('data', paste0('out', s, '_', i, '-', 3, '.Rdata'))))))

max_rhat <- max(gelman.diag(chains[,pars], multivariate=F, autoburnin=F)$psrf[,1], na.rm = T)

## posterior medians
out_temp <- data.frame(t(c(summary(chains)$q[pars,"50%"], max_rhat, i, s)))
colnames(out_temp) <- c(names(summary(chains)$q[pars,"50%"]), 'max_rhat', 'sim', 'scenario')

out_meds1 <- rbind(out_meds1, out_temp)

  } #sims
} #scenarios

#scenarios without p.surv
sc <- c(6:10)
pars <- c('fec', 'lambdaf', 'mean.p', 'mean.phi[1]', 'mean.phi[2]', 'phi.nest')

out_meds2 <- data.frame() #storage
for (s in sc) {
  for (i in 1:nsim) { 
chains <- as.mcmc.list(list(as.mcmc(readRDS(file = here::here('data', paste0('out', s, '_', i, '-', 1, '.Rdata')))), 
                            as.mcmc(readRDS(file = here::here('data', paste0('out', s, '_', i, '-', 2, '.Rdata')))), 
                            as.mcmc(readRDS(file = here::here('data', paste0('out', s, '_', i, '-', 3, '.Rdata'))))))

max_rhat <- max(gelman.diag(chains[,pars], multivariate=F, autoburnin=F)$psrf[,1], na.rm = T)

## posterior medians
out_temp <- data.frame(t(c(summary(chains)$q[pars,"50%"], max_rhat, i, s)))
colnames(out_temp) <- c(names(summary(chains)$q[pars,"50%"]), 'max_rhat', 'sim', 'scenario')

out_meds2 <- rbind(out_meds2, out_temp)

  } #sims
} #scenarios

out_meds <- bind_rows(out_meds1, out_meds2)

post_meds <- out_meds %>% 
  filter(max_rhat < 1.1) %>%
  dplyr::select(-c(max_rhat, lambdaf)) %>%
  reshape2::melt(id.vars = c('scenario', 'sim')) %>%
  filter(variable %in% c('mean.phi[1]', 'mean.phi[2]', 'mean.p', 'fec', 'p.surv', 'phi.nest')) %>%
  transform(variable = factor(variable,
                              levels = c('mean.phi[1]', 'mean.phi[2]', 'mean.p', 'fec', 'p.surv', 'phi.nest'),
                              labels = c('JuvSurv', 'AdultSurv', 'MRdetection', 'Fec', 'Abunddetection', 'Dailynestsurvival'))) %>%
  transform(Data = ifelse(scenario < 6, 'All', 
                          ifelse(scenario < 11 & scenario > 5, 'Counts + Productivity', 'Counts + MR')))

meds_plot <- ggplot(post_meds, aes(y = value, x = scenario, group = scenario)) +
  geom_boxplot(aes(color = Data)) +
  geom_point(size = 0.7, col = 'darkgrey') + 
  geom_point(data = true_vals, aes(y = Truth, x = scenario, group = scenario), col = 'darkred') +
  xlab('Scenario') + ylab('Posterior medians') +
  facet_wrap(~variable, scales = 'free_y') +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
        legend.position = 'top') +
  scale_x_continuous(breaks = 1:15) +
  scale_color_manual(values = cols[c(2,3,5)])

#relative bias
bias_vals <- post_meds %>% 
  merge(true_vals %>% dplyr::select(scenario, variable, Truth), by = c('scenario', 'variable')) %>%
  transform(bias = value-Truth, rel_bias = (value-Truth)/Truth) 

bias_plot <- ggplot(bias_vals, aes(y = rel_bias, x = scenario, group = scenario)) +
  geom_boxplot(aes(color = Data)) +
  geom_point(size = 0.7, col = 'darkgrey') + 
  geom_hline(aes(yintercept = 0), linetype = 'dashed', col = 'darkred') +
  xlab('Scenario') + ylab('Relative bias') +
  facet_wrap(~variable, scales = 'free_y') +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
        legend.position = 'top') +
  scale_x_continuous(breaks = 1:15) +
  scale_color_manual(values = cols[c(2,3,5)])

#rmse
rmse_vals <- post_meds %>% 
  merge(true_vals %>% dplyr::select(scenario, variable, Truth), by = c('scenario', 'variable')) %>%
  transform(rmse.temp = (value-Truth)^2) %>%
  group_by(Data, scenario, variable) %>%
  dplyr::summarize(rmse = sqrt(mean(rmse.temp)))

rmse_plot <- ggplot(rmse_vals, aes(y = rmse, x = scenario, group = scenario)) +
  geom_boxplot(aes(color = Data)) +
  geom_point(size = 0.7, col = 'darkgrey') +
  geom_hline(aes(yintercept = 0), linetype = 'dashed', col = 'darkred') +
  xlab('Scenario') + ylab('RMSE') +
  facet_wrap(~variable, scales = 'free_y') +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
        legend.position = 'top') +
  scale_x_continuous(breaks = 1:15) +
  scale_color_manual(values = cols[c(2,3,5)])

figs("rmse_plot", caption = "Figure of RMSE per scenario.")


```

```{r summary table}

posterior_summary <- post_meds %>%
  group_by(scenario, variable) %>%
  dplyr::summarize(post_med = round(median(value), 2)) %>%
  dcast(scenario ~ variable, value.var = 'post_med')

bias_summary <- bias_vals %>%
  group_by(scenario, variable) %>%
  dplyr::summarize(mean_bias = round(mean(rel_bias), 2)) %>%
  dcast(scenario ~ variable, value.var = 'mean_bias')

rmse_summary <- rmse_vals %>%
  group_by(scenario, variable) %>%
  dplyr::summarize(mean_rmse = round(mean(rmse), 2)) %>%
  dcast(scenario ~ variable, value.var = 'mean_rmse')


```


**Title**  

Ideas: 
- Performance of integrated population models across varying data landscapes  
- When and how far can we push the integrated population model framework? Estimating demographic parameters under variable data landscapes  
- Pushing the limits: examining minimal data requirements for estimating demographic parameters in an integrated population model framework  

Abby Bratt, Caroline Cappello, Amelia DuVall, Hannah Sipe, Amanda Warlick


**Introduction**  

Understanding the processes that control population dynamics in wild populations is a critical component of conservation and management but is frequently limited by missing demographic information, uncertainty, and temporally or spatially misaligned datasets (Schaub & Abadi 2011, Zipkin & Saunders 2017). Integrated population models (IPMs; Besbeas et al. 2002, Brooks et al. 2004) are an increasingly popular tool in ecology that can help overcome these limitations by combining disparate datasets in a single, unified analysis (Schaub & Abadi 2011). This approach can provide several advantages, such as improved precision (Schaub et al. 2007, Tavecchia 2009, Abadi et al. 2010) and the estimation of parameters that would otherwise be unidentifiable (Besbeas 2005, Schaub et al. 2007, Veran & Lebreton 2008), which is often the case for key demographic rates such as recruitment or immigration. These advances have practical benefits for resource managers that must make decisions based on limited available information. As IPMs become more widely used, however, it is critical that they are robustly evaluated. 

Since the introduction of IPMs to ecology in the early 2000s and following the work of Besbeas and colleagues with passerines (Besbeas et al. 2002, 2005), the common approach has been to estimate parameters by combining mark-recapture and abundance data into a joint likelihood. Researchers have has since expanded the use of IPMs to include a variety of taxa (e.g., bats *Rhinolophus ferrumequinum* (Schaub et al. 2007); Svalbard reindeer *Rangifer tarandus platyrhynchus* (Lee et al. 2015), Antarctic toothfish *Dissostichus mawsoni* (Mormede et al. 2019), wild boar *Sus scrofa* (Gamelon et al. 2019)). Applications have also been developed to estimate transition probabilities within multi-state and multi-site systems (McCrea et al. 2012), evaluate management efficacy and trade-offs (Cruz et al. 2018), and to estimate the effects of environmental processes and stochasticity on demography (Oppel et al. 2014, Woodworth et al. 2017). This proliferation of integrated population modeling has occurred despite a relatively poor understanding of how to assess goodness of fit for the joint likelihood. Additionally, the limitations of the IPM framework are still underexplored, particularly in situations where available data are sparse, of poor quality, or when data to inform specific parameters are entirely absent (i.e., most field studies may have count surveys, but not all have data informing both recruitment and survival). 

Data simulation studies provide an avenue for robust evaluations of the IPM framework, but few such studies exist. Those that have used data simulation largely focus on (1) proof of concept (i.e., improved precision and reduced bias of parameter estimation) or (2) violation of assumptions within the subcomponent models (i.e., marker-induced bias or heterogeneity in survival) or the joint likelihood (i.e., dataset independence). In the former, IPMs generally have led to improved precision and unbiased estimates of parameters that would otherwise be unidentifiable using traditional approaches (McCrea et al. 2010, Chandler & Clark 2014, Schaub & Fletcher 2015, Bled et al. 2017, Ahrestani et al. 2017, Bowler et al. 2019), though not always depending on sample sizes, dominance of one dataset over another, or the likelihood structures (citation). In examining the effects of violating model assumptions on bias and precision, results have been mixed and again largely depend on sample sizes, effect sizes, parameterization, and the dominance of given datasets. In some cases, dependence across datasets has been shown to result in biased estimates or at least overly optimistic estimates of uncertainty (Goodman et al. 2004, Besbeas et al. 2009) while in others the effects on bias and precision are minimal (Abadi et al. 2010, Schaub & Fletcher 2015, Weegman et al. 2020). Riecke et al. (2019) found that estimates for previously unidentifiable parameters were highly sensitive to violations of mark-recapture model assumptions (i.e., marker-induced bias and survival heterogeneity). 

These studies motivate the further examination of the strengths and weaknesses IPMs across a range of model structures and data landscapes, particularly when certain demographic rates are not directly informed by data or when a data source is sparse, biased, or highly uncertain. This type of analysis has been conducted for species distribution models in a few cases (Farr et al. 2020, Simmonds et al. 2020), but has not yet been rigorously explored for an IPM. Through a simulation analysis, we aim to gain insights about this statistical framework, particularly as applied to a passerine bird life history. We compare parameter estimation for a traditional IPM with data informing abundance (count data), survival (mark-recapture data), and reproductive output (nest monitoring data) to situations when either of the latter two datasets are omitted. In each of these three cases, we also examine parameter estimation when juvenile survival varies and under situations with low detection to reflect a higher degree of uncertainty. In future iterations of this analysis, we also plan to compare model performance in situations when datasets informing survival and reproduction are not only uncertain (low detection probability) but also sparse (reduced survey frequency), and the effects of having lower or variable adult survival and reproductive output.

Through this study, we will identify scenarios where IPMs may not lead to improved precision or return unbiased estimates of parameters that would otherwise be unidentifiable when certain datasets are excluded. In doing so, we will refine our understanding of the mechanisms underlying IPMs and can better identify when they may serve as a useful tool or might not be necessary or warrant the collection of additional data. Improving our understanding of the strengths and weaknesses of the IPM framework can provide helpful insights for the design and implementation of field survey programs so as to most efficiently make use of limited resources to inform management efforts aimed at monitoring or recovering species that are deemed ecosystem indicators or depleted and in need of conservation intervention.

**Methods**   

*Data simulation: life history*  
We simulated data for an avian species assuming life history stages and traits of a typical passerine. Our simulated hypothetical species has two age-classes: young-of-year (YOY) and adults. Each age class has a unique survival rate ($S_1$, $S_{ad}$) and adults produce new chicks at rate *f*, and those chicks survive to be YOY at rate $S_1$. Current YOY will also breed the following year to produce surviving chicks at rate $f \times S_1$ (Fig 1). We assume an annual breeding cycle, with females nesting once per year. The period from nest initiation to fledging is 30 days regardless of clutch size. 

As is often the convention, we use a female-only model because we assume that the population dynamics of our species are driven largely by female abundance and demography. All demographic rates are assumed constant over a 15-year study period. The population is quite small and the survey extends across the entire range, therefore we assume no immigration or emigration.

*Model framework and assumptions*  

*Count model*  
We simulated data such that the population is surveyed annually in a 15-year pre-breeding census. Count surveys are conducted three times per year in quick succession such that we assume the population is closed between secondary sampling periods. We use an N-mixture model (citations) to estimate annual abundance from these repeated counts, where we assume no individual is double counted and that individual detections are independent and occur with equal probability. The underlying state process represents the latent variables of stage-specific abundance at each occasion: 

$$N_{1, t+1} \sim \text{Poisson}(N_{1,t}, S_{1,t}, \frac{f_t}{2} + N_{ad,t}S_{ad,t},\frac{f_t}{2})$$  

$$N_{ad,t+1} \sim \text{Binomial}(N_{1,t} + N_{ad,t}, S_{ad,t})$$  

where the number of juveniles ($N_1$) is estimated using a Poisson distribution with probability based on the sum of stage-specific individuals that survive ($S_{1,ad}$) and reproduce ($f_t$). A binomial distribution is used to estimate the number of adults based on the stage-specific survival and abundance in the previous occasion. 

The observation process model, 

$$y_t = N_{tot, t} + \epsilon$$
$$\epsilon \sim \text{Normal}(0, \sigma^2_y)$$

describes counts *y* at time *t* given given stage-specific abundance as binomially distributed with sample size $N_t$ and detection probability $p$, with normally distributed observation error $\epsilon$ estimated with mean = 0 with the prior for $\sigma_y$ being U(0,10). 
<!-- from amanda: help - prior for observation error?  -->

The overall likelihood for this hierarchical state-space model can be described as the product of the state and observation process models:
$$L_{SS}(\text{y}|\text{N}, S_1, S_{ad}, f, \sigma^2_y) = L_O(\text{y}|\text{N},\sigma^2_y) \times L_S(\text{N}|S_1, S_{ad}, f)$$
 
*Nest success productivity model*   

In this simulation, nests are monitored according to the procedures described in Martin and Geupel (1993), where adults are observed for behavioral clues that indicate nesting behavior and followed until a nest is found. After locating a nest, it is revisited every 2-3 days to check its status until it either fledges or fails. We assume no state uncertainty in our nest observations, that nests can be correctly aged when first found, and that monitored nests are independent and representative of the population. We assume the daily survival probability is uniform across nest stages (*i.e.*, laying, incubating, nestlings). We estimate daily nest survival to obtain unbiased estimates for the probability of nest success (*i.e.*, at least 1 chick fledges): We use a Poisson model to estimate the average number of chicks fledged conditional on a nest being successful.

$$J_t \sim \text{Poisson}(\rho_t) $$
$$\rho_t = R_tf_t $$

where the number of nestlings counted $J$ in year *t* is modeled using a Poisson distribution with the product of the number of surveyed broods $R_t$ and fecundity $f_t$ at each occasion. Fecundity is estimated using a uniform prior (0, 20) and the likelihood of this daily nest survival model can be described as $L_P(\text{J}, \text{R}|\text{f})$. 

*Mark-resight model*  
In this simulation study, YOY chicks are marked in the nest just prior to fledging with a unique combination of colored leg bands such that they can be individually identified over the course of their lives. Every chick in every nest that fledges is banded from a single annual comprehensive mark-resight survey per breeding season. To estimate stage-specific survival based on the individual encounter histories, we use a Cormack-Jolly-Seber (citation) model where we assume that marks are not lost or misread and that each marked individual has independent and identical survival and detection probabilities across occasions. The ecological state process *z* describes the probability that individual *i* at time *t* is alive or dead, namely:  

$$ z_{i,t}|z_{i,t-1} \sim \text{Bernoulli}(z_{i,t-1} S_{1,ad}) $$

where the state at time *t* is modeled with a Bernouli distribution based on the state at the previous occasion and state-specific survival probabilities $S_1$ and $S_{ad}$. Similarly, the observation process model

$$ y_{i,t}|z_{i,t} \sim  \text{Bernoulli}(z_{i,t} p)$$
  
describes observations *y* using a Bernouli distribution based on the state of the individual in the current occasion and detection probability *p*. Mean survival and detection probabilities are modeled on the probability scale using uniform priors, $S_{1,ad} \sim \text{Uniform}(0,1)$ and $p \sim \text{Uniform}(0,1)$, respectively. The overall likelihood of the mark-resight model estimating survival probabilities is the product of the state and observation process models: $L_{SS}(\text{y}|\text{z}, ~S_1, ~S_{ad}, ~\text{p}) = L_O(\text{y}|\text{z},~\text{p})     \times L_S(\text{z}|S_1,~S_{ad})$.

*Integrated population model*  

To estimate abundance of the overall population $N_{tot}$ at each time *t*, the parameter estimates from the productivity and mark-resight models are combined with the stage-specific abundane estimated using the N-mixture model in a stochastic leslie population matrix model.

<!-- From amanda: help: not sure if we need something like this since we have the equations above? -->
<!-- $$ \left[\begin{array} -->
<!-- {l} -->
<!-- N_{1,t+1} \sim \text{Binomial}(N_{1,t},~S_{1,t}) \\ -->
<!-- N_{ad,t+1} \sim \text{Binomial}(N_{ad,t},~S_{ad,t}) \\ -->
<!-- N_{Tot, t+1} = N_{1,t} + N_{ad,t} -->
<!-- \end{array}\right]  -->
<!-- $$  -->

The joint likelihood for the integrated population model is the product of the likelihoods for the three subcomponent models. In instances when one dataset is removed, informative priors are used in place of the data to inform each of the relevant parameters (Table 1). 

[IPM joint likelihood equation]

*Simulation scenarios* 

Scenarios - see sheet  

Metrics to monitor  
CV (precision)  
RMSE (accuracy)  
Relative bias  

Vary data quantity/combinations and demographic rates  
Low MR detection vs high  
Low daily nest survival vs high  
Low abund detection vs high  

Best scenario, using all three datasets  
Potential add-on: vary life history traits:  
Survival: 0.3 vs. 0.8  
Fecundity: 0.3 vs. 0.5  
Remove nest monitoring entirely - use other two datasets (MR and counts)  
Model adjustments: informed priors?   
Sensitivity to priors?  
Remove MR data entirely - use other two datasets (nest monitoring and counts)  
Model adjustments: informed priors?  
Sensitivity to priors?   
Poorer quality MR  
Quantity: decrease N (20 individuals vs. 100 resights per year)  
Quality: decrease p (0.1, 0.5, 0.8) or annual surveys (5 vs. 10)  

*Estimation and diagnostics*   
Nimble; iterations, burn-in, etc  
Examined relative bias, RMSE, etc  

**Results**  

**Discussion**  

Review project aim and main findings  

Elaborate on interesting finding 1  
- Implications of not exploring this in an application?  
- Future areas of work?  
- Extension to more complex life history? Data scenarios?  

Elaborate on interesting finding 2
- Implications of not exploring this in an application?  
- Future areas of work?  
- Extension to more complex life history? Data scenarios?  

Broaden to implications of work, study design, existing IPMs


\newpage


**Literature cited**  

Abadi, F., Gimenez, O., Arlettaz, R., Schaub, M., 2010. An assessment of integrated population models: bias, accuracy, and violation of the assumption of independence. Ecology 91, 7–14. https://doi.org/10.1890/08-2235.1

Ahrestani, F.S., Saracco, J.F., Sauer, J.R., Pardieck, K.L., Royle, J.A., 2017. An integrated population model for bird monitoring in North America. Ecol Appl 27, 916–924. https://doi.org/10.1002/eap.1493

Bled, F., Belant, J.L., Daele, L.J.V., Svoboda, N., Gustine, D., Hilderbrand, G., Barnes, V.G., n.d. Using multiple data types and integrated population models to improve our knowledge of apex predator population dynamics. Ecology and Evolution 7, 9531–9543. https://doi.org/10.1002/ece3.3469

Bowler, D.E., Nilsen, E.B., Bischof, R., O’Hara, R.B., Yu, T.T., Oo, T., Aung, M., Linnell, J.D.C., 2019. Integrating data from different survey types for population monitoring of an endangered species: the case of the Eld’s deer. Scientific Reports 9, 7766. https://doi.org/10.1038/s41598-019-44075-9

Chandler, R.B., Clark, J.D., 2014. Spatially explicit integrated population models. Methods in Ecology and Evolution 5, 1351–1360. https://doi.org/10.1111/2041-210X.12153

Farr, M.T., Green, D.S., Holekamp, K.E., Zipkin, E.F., n.d. Integrating distance sampling and presence-only data to estimate species abundance. Ecology n/a, e03204. https://doi.org/10.1002/ecy.3204

McCrea, R.S., Morgan, B.J.T., Gimenez, O., Besbeas, P., Lebreton, J.-D., Bregnballe, T., 2010. Multi-Site Integrated Population Modelling. Journal of Agricultural, Biological and Environmental Statistics 15, 539–561. https://doi.org/10.1007/s13253-010-0027-5 

Riecke, T.V., Williams, P.J., Behnke, T.L., Gibson, D., Leach, A.G., Sedinger, B.S., Street, P.A., Sedinger, J.S., 2019. Integrated population models: model assumptions and inference. Methods Ecol Evol 2041–210X.13195. https://doi.org/10.1111/2041-210X.13195

Schaub, M., Fletcher, D., 2015. Estimating immigration using a Bayesian integrated population model: choice of 
parametrization and priors. Environ Ecol Stat 22, 535–549. https://doi.org/10.1007/s10651-015-0309-8

Simmonds, E.G., Jarvis, S.G., Henrys, P.A., Isaac, N.J.B., O’Hara, R.B., 2020. Is more data always better? A simulation study of benefits and limitations of integrated distribution models. Ecography 43, 1413–1422. https://doi.org/10.1111/ecog.05146

Sun, C.C., Royle, J.A., Fuller, A.K., 2019. Incorporating citizen science data in spatially explicit integrated population models. Ecology 100, e02777. https://doi.org/10.1002/ecy.2777

Tavecchia, G., Besbeas, P., Coulson, T., Morgan, B.J.T., Clutton‐Brock, T.H., 2009. Estimating Population Size and Hidden Demographic Parameters with State‐Space Modeling. The American Naturalist 173, 722–733. https://doi.org/10.1086/598499

Weegman, M.D., Arnold, T.W., Clark, R.G., Schaub, M., 2020. Partial and complete dependency among data sets has minimal consequence on estimates from integrated population models. Ecological Applications. https://doi.org/10.1002/eap.2258

 
\newpage

**Figures and Tables**  

```{r plots, fig.height = 8.5, fig.width = 7, fig.align = 'center'}

# plots
rmse_plot

```

`r figs("rmse_plot", caption = "Plot of RMSE per scenario.")`


\newpage

`r tbls("rmse_summary", caption = "Table of RMSE by scenario.")`
```{r table}

kable(rmse_summary, align = 'c', format.args = list(big.mark = ","))

```



